var tablinks,select_tag,input_tag,button_tag,changes=!1;jQuery(document).ready(function(e){e(".superpwa-colorpicker").wpColorPicker(),e(".superpwa-colorpicker").wpColorPicker("option","change",function(e,t){changes=!0}),e(".superpwa-icon-upload").click(function(t){t.preventDefault();var a=wp.media({title:"Application Icon",button:{text:"Select Icon"},multiple:!1}).on("select",function(){var t=a.state().get("selection").first().toJSON();e(".superpwa-icon").val(t.url)}).open()}),e(".superpwa-maskable-icon-upload").click(function(t){t.preventDefault();var a=e(this),n=wp.media({title:"Maskable Icon",button:{text:"Select Icon"},multiple:!1}).on("select",function(){var e=n.state().get("selection").first().toJSON();a.parents("td").find(".superpwa-maskable-input").val(e.url),superpwa_check_maskable_input()}).open()}),e(".superpwa-splash-icon-upload").click(function(t){t.preventDefault();var a=wp.media({title:"Splash Screen Icon",button:{text:"Select Icon"},multiple:!1}).on("select",function(){var t=a.state().get("selection").first().toJSON();e(".superpwa-splash-icon").val(t.url)}).open()}),e(".superpwa-screenshots-upload").click(function(t){t.preventDefault();var a=wp.media({title:"Screenshots",button:{text:"Select Icon"},multiple:!0}).on("select",function(){var t=a.state().get("selection").toJSON(),n=t.length,s=[];if(n>8){alert("Screenshots must be less than or equal to 8");return}if(n>0)for(var r=0;r<n;r++)s.push(t[r].url);e(".superpwa-screenshots").val(s.join(","))}).open()}),e(".superpwa-monochrome-upload").click(function(t){t.preventDefault();var a=wp.media({title:"Monochrome Icon",button:{text:"Select Icon"},multiple:!1}).on("select",function(){var t=a.state().get("selection").first().toJSON();e(".superpwa-monochromeicon").val(t.url)}).open()}),e(".superpwa-app-short-name").on("input",function(t){e(".superpwa-app-short-name").val().length>15?(e(".superpwa-app-short-name").css({color:"#dc3232"}),e("#superpwa-app-short-name-limit").css({color:"#dc3232"})):(e(".superpwa-app-short-name").css({color:"inherit"}),e("#superpwa-app-short-name-limit").css({color:"inherit"}))}),e("#superpwa_newsletter").submit(function(e){var t=jQuery(this).find('input[name="newsletter-email"]').val();return jQuery.post(ajaxurl,{action:"superpwa_newsletter_submit",email:t,superpwa_security_nonce:superpwa_obj.superpwa_security_nonce},function(e){}),!0}),e(".superpwa_newsletter_hide").click(function(e){return jQuery(".superpwa-newsletter-wrapper").css("display","none"),jQuery(this),jQuery.post(ajaxurl,{action:"superpwa_newsletter_hide_form",superpwa_security_nonce:superpwa_obj.superpwa_security_nonce},function(e){}),!0}),e("#toplevel_page_superpwa").find("ul").find("li").each(function(t,a){arr=["superpwa","settings","add-ons","license","upgrade to pro"];var n=e(this).text().toLowerCase();-1===e.inArray(n,arr)&&e(this).hide()});let t=new URLSearchParams(window.location.search);if(arr=["superpwa","superpwa-addons","superpwa-upgrade"],-1===e.inArray(t.get("page"),arr)){var a,n=e(".wrap").find("h1").html();e(".wrap").find("h1").html('<a href="./admin.php?page=superpwa-addons" style="text-decoration:none;color: #5b5b5d;">SuperPWA Add-ons</a> > '+n)}(a=jQuery(".superpwa-select2")).length>0&&jQuery(a).each(function(e,t){var a=jQuery(this),n=jQuery("option[value]:not([selected])",a),s=[];n.each(function(){var e=jQuery(this);s.push({id:e.attr("value"),text:e.text()})});var r=jQuery("#superpwa_settings_startpage_type").val();r="page",a.hasClass("js_post")&&(r="post");var i=ajaxurl+"?action=superpwa_get_select2_data&superpwa_security_nonce="+superpwa_obj.superpwa_security_nonce+"&type="+r;a.select2({ajax:{url:i,delay:250,cache:!1},minimumInputLength:2,minimumResultsForSearch:50,dataAdapter:jQuery.fn.select2.amd.require("select2/data/extended-ajax"),defaultResults:s})})});var image="";function superpwaOnFileUploadChange(e){var t=e.target.files[0],a=new FileReader;a.onload=function(e){image=e.target.result,document.getElementById("thumbnail").src=e.target.result,document.getElementById("thumbnail").style.display="none"},a.readAsDataURL(t),document.getElementById("aft_img_gen").innerHTML="Generating Images Please Wait...",setTimeout(function(){superpwaGetZip()},300)}function superpwaGetZip(){if(jQuery("#aft_img_gen").text("Generating Images Please Wait..."),""==image){alert("Please Select Image"),jQuery("#superpwa-apple-splash-message").text("");return}var e=new JSZip,t=e.folder("super_splash_screens"),a=document.createElement("canvas"),n=a.getContext("2d"),s=new Image;s.src=image;var r=JSON.parse(document.getElementById("iosScreen-data").innerHTML);Object.keys(r).forEach(function(e,i){var o=r[e],p=e.split("x")[0],c=e.split("x")[1];a.width=p,a.height=c;var u=s.width,d=s.height,f=u,g=d;if(!0==document.getElementById("center-mode").checked)n.fillStyle=document.getElementById("ios-splash-color").value,n.fillRect(0,0,a.width,a.height);else{var m=p/c>u/d?p/u:c/d;f=u*m,g=d*m}n.drawImage(s,(p-f)/2,(c-g)/2,f,g);var v=a.toDataURL();t.file(o.file,v.split(";base64,")[1],{base64:!0})}),e.generateAsync({compression:"DEFLATE",type:"blob"}).then(function(e){var t="splashscreens.zip",a=new File([e],t,{type:"application/zip"});let n=(a.size/1024/1024).toFixed(2);var s=new FormData;s.append("fileName",t),s.append("file",a),s.append("action","superpwa_splashscreen_uploader"),s.append("security_nonce",superpwaIosScreen.nonce),s.append("mimeType","application/zip");var r=superpwaIosScreen.max_file_size;n<parseFloat(r.replace("M",""))?jQuery.ajax({type:"POST",url:ajaxurl,data:s,dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(e){200==e.status?(jQuery("#thumbnail").css("display","block"),jQuery("#aft_img_gen").text("Touch Icons Generated Successfully"),jQuery("#aft_img_gen").css({color:"green","margin-bottom":"20px"}),jQuery("#submit_splash_screen").trigger("click")):(jQuery("#thumbnail").css("display","block"),jQuery("#aft_img_gen").text(e.message),jQuery("#aft_img_gen").css({color:"red","margin-bottom":"20px"}))}}):(jQuery("#thumbnail").css("display","block"),jQuery("#aft_img_gen").text("Generated zip file size("+n+"MB) excceding to server max file size "+r),jQuery("#aft_img_gen").css({color:"red","margin-bottom":"20px"}))})}if(document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("upload_apple_function");e&&e.addEventListener("change",superpwaOnFileUploadChange,!1)}),tablinks=document.getElementsByClassName("spwa-tablinks"),select_tag=document.getElementsByTagName("select"),input_tag=document.getElementsByTagName("input"),button_tag=document.getElementsByTagName("button"),input_tag)for(var h=0;h<input_tag.length;h++)input_tag[h].addEventListener("change",function(e){changes=!0});if(select_tag)for(var j=0;j<select_tag.length;j++)select_tag[j].addEventListener("change",function(e){changes=!0});if(button_tag)for(var k=0;k<button_tag.length;k++)button_tag[k].addEventListener("click",function(e){changes=!0});if(tablinks)for(var l=0;l<tablinks.length;l++)tablinks[l].addEventListener("click",function(e){changes&&(window.onbeforeunload=function(e){return"Sure you want to leave?"})});jQuery(document).on("click",".superpwa-reset-settings",function(e){e.preventDefault(),!0==confirm("Are you sure?")&&jQuery.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"superpwa_reset_all_settings",superpwa_security_nonce:superpwa_obj.superpwa_security_nonce},success:function(e){setTimeout(function(){location.reload()},1e3)},error:function(e){console.log(e)}})}),jQuery(".superpwa-install-require-plugin").on("click",function(e){e.preventDefault();var t=jQuery(this);t.html("Installing..").addClass("updating-message");var a=t.attr("data-secure");t.attr("data-activate-url");var n=t.attr("id"),s="";"pushnotification"==n&&(s="&activate=pushnotification"),console.log(wp.updates),jQuery.ajax({url:ajaxurl,type:"post",data:"action=superpwa_enable_modules_upgread"+s+"&verify_nonce="+a,dataType:"json",success:function(e){200==e.status?t.hasClass("not-exist")?wp.updates.installPlugin({slug:e.slug,success:function(n){console.log(n.activateUrl),superpwa_Activate_Modules_Upgrade(n.activateUrl,t,e,a)}}):superpwa_Activate_Modules_Upgrade(t.attr("data-activate-url"),t,e,a):alert(e.message)}})});var superpwa_Activate_Modules_Upgrade=function(e,t,a,n){void 0!==e&&e&&(console.log("Activating..."),t.html("Activating..."),jQuery.ajax({async:!0,type:"GET",url:e,success:function(){var e="";"pushnotification"==t.attr("id")&&(e="push notification",console.log("push notification Activated"),t.removeClass("updating-message"),t.removeClass("button"),t.removeClass("superpwa-install-require-plugin"),t.unbind("click"),t.html('<a target="_blank" href="'+a.redirect_url+'" style="color:#fff;text-decoration:none;">View Settings</a>'))},error:function(e,t){var a="";a=0===e.status?"Not connect.\n Verify Network.":404===e.status?"Requested page not found. [404]":500===e.status?"Internal Server Error [500].":"parsererror"===t?"Requested JSON parse failed.":"timeout"===t?"Time out error.":"abort"===t?"Ajax request aborted.":"Uncaught Error.\n"+e.responseText,console.log(a)}}))};function superpwa_check_maskable_input(){jQuery(".superpwa-maskable-input").each(function(){console.log(jQuery(this).val()),null==jQuery(this).val()||""==jQuery(this).val()?jQuery(this).parents("td").find(".superpwa_js_remove_maskable").hide():jQuery(this).parents("td").find(".superpwa_js_remove_maskable").show()})}jQuery("#screenshots_add_more").click(function(e){e.preventDefault(),(clone_tr=jQuery(this).parents(".js_clone_div:first").clone()).find("input").val(""),clone_tr.find("input").prop("name","superpwa_settings[screenshots_multiple][]"),clone_tr.find("select").prop("name","superpwa_settings[form_factor_multiple][]"),clone_tr.find("select").prop("selectedIndex",0),clone_tr.find("#screenshots_add_more").remove(),clone_tr.find(".js_remove_screenshot").show(),clone_tr.find(".js_choose_button").addClass("superpwa-screenshots-multiple-upload"),clone_tr.find(".js_choose_button").removeClass("superpwa-screenshots-upload"),clone_tr.insertAfter(".js_clone_div:last")}),jQuery("body").on("click",".js_remove_screenshot",function(e){e.preventDefault(),jQuery(this).parents(".js_clone_div").remove()}),jQuery("body").on("click",".superpwa-screenshots-multiple-upload",function(e){e.preventDefault(),this_=jQuery(this).parents(".js_clone_div");var t=wp.media({title:"Screenshots",button:{text:"Select Icon"},multiple:!1,library:{type:"image"}}).on("select",function(){var e=t.state().get("selection").first().toJSON();this_.find(".superpwa-screenshots").val(e.url)}).open()}),jQuery(".superpwa_js_remove_maskable").click(function(e){e.preventDefault(),jQuery(this).parents("td").find(".superpwa-maskable-input").val(""),jQuery(this).hide()}),jQuery(".superpwa-maskable-input").keyup(function(){null==jQuery(this).val()||""==jQuery(this).val()?jQuery(this).parents("td").find(".superpwa_js_remove_maskable").hide():jQuery(this).parents("td").find(".superpwa_js_remove_maskable").show()}),superpwa_check_maskable_input();